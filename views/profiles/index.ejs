<%- include('../partials/html-head') %> <%- include('../partials/nav') %>

<main>
  <div id="topSpaceBuffer"></div>
  <div class="indexContainer">
    <% profiles.forEach(profile => { %>
    <a href="/profiles/<%= profile._id %>">
      <div class="userProfileIndex">
        <% if (profile.avatar) { %>
        <img
          class="card-img-top"
          src="<%= profile.avatar %>"
          alt="<%= profile.name %>'s avatar"
          width="100%"
        />
        <% } else { %>
        <img
          class="card-img-top"
          src="/images/icons/user.png"
          alt="A placeholder avatar"
          width="100%"
        />
        <% } %>
        <div id="userInfo">
          <h2><%= profile.name %></h2>
          <% let total=0 %> <% let profileI = `${profile._id}` %> <%
          projects.forEach(project => { %> <% let pOwner = `${project.owner}` %>
          <% if (pOwner===profileI && project.visible) { %> <% total+=1 %> <%}
          %> <% })%>
          <p><b>projects contributed: <%=total %></b></p>
          <% let total2=0 %> <% let profileM = `${profile._id}` %>
          <p>
            <b>Joined: <%=profile.createdAt.toString().substring(0,15)%></b>
          </p>
        </div>
      </div>
    </a>
    <% }) %>
  </div>
  <%- include('../partials/footer') %>
</main>
